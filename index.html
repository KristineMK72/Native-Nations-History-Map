<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Echoes of the Land — Indigenous History Story Map</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <link rel="stylesheet" href="./styles.css" />

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <script src="https://unpkg.com/scrollama"></script>
  </head>

  <body>
    <div id="app">
      <aside id="story" aria-label="Story">
        <header class="storyHeader">
          <div class="titleBlock">
            <h1>Echoes of the Land</h1>
            <p class="subtitle">Indigenous History Story Map</p>
          </div>
          <div class="headerActions">
            <button id="btnAbout" class="chip">About</button>
            <button id="btnShare" class="chip">Share</button>
          </div>
        </header>
        <div id="storyBody"></div>
        <footer class="storyFooter">
          <div class="hint">Tip: Scroll to advance • Click map for details</div>
        </footer>
      </aside>

      <main id="mapWrap">
        <div id="map"></div>

        <div id="hud">
          <div class="hudRow">
            <button id="btnToggleStory" class="hudBtn">☰</button>
            <div class="hudTitle">
              <div id="hudChapterTitle">Loading…</div>
              <div id="hudChapterMeta">—</div>
            </div>
            <button id="btnLegend" class="hudBtn">◎</button>
            <button id="btnLayers" class="hudBtn">⧉</button>
          </div>

          <div class="hudRow hudTransport">
            <button id="btnPrev" class="transportBtn">⏮︎</button>
            <button id="btnPlay" class="transportBtn">⏯︎</button>
            <button id="btnNext" class="transportBtn">⏭︎</button>
            <div class="progress">
              <div id="progressText" class="progressText">0 / 0</div>
              <div class="progressBar"><div id="progressFill" class="progressFill"></div></div>
            </div>
          </div>

          <div id="layersPanel" class="panel hidden">
            <div class="panelTitle">Layers</div>
            <label class="toggle"><input id="toggleTribes" type="checkbox" checked /> <span>Tribes</span></label>
            <label class="toggle"><input id="toggleTrails" type="checkbox" checked /> <span>Trails</span></label>
            <label class="toggle"><input id="toggleReservations" type="checkbox" /> <span>Reservations</span></label>
            <label class="toggle"><input id="toggleAudio" type="checkbox" /> <span>Audio</span></label>
          </div>

          <div id="legendPanel" class="panel hidden">
            <div class="panelTitle">Legend</div>
            <div class="legendItem"><span class="swatch swatchTribes"></span><span>Tribal locations</span></div>
            <div class="legendItem"><span class="swatch swatchReservations"></span><span>Reservations</span></div>
            <div class="legendItem"><span class="swatch swatchTears"></span><span>Trail of Tears</span></div>
            <div class="legendItem"><span class="swatch swatchOjibwe"></span><span>Ojibwe Migration</span></div>
          </div>
        </div>

        <div id="modalBackdrop" class="modalBackdrop hidden"></div>
        <div id="modal" class="modal hidden">
          <div class="modalHeader">
            <div class="modalTitle">About</div>
            <button id="btnCloseModal" class="modalClose">×</button>
          </div>
          <div class="modalBody">
            <p>Educational visualization of Indigenous presence and migration.</p>
          </div>
        </div>

        <audio id="ambientAudio" loop><source src="./audio/powwow.mp3" type="audio/mpeg" /></audio>
      </main>
    </div>

    <script type="module" src="./app.js"></script>
  </body>
</html>
